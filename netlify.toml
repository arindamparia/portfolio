[build]
  command = "bun run build"
  functions = "netlify/functions"
  publish = "dist"

[[redirects]]
  from = "/api/*"
  to = "/.netlify/functions/:splat"
  status = 200

[[headers]]
  for = "/*"
  [headers.values]
    X-Frame-Options = "DENY"
    X-XSS-Protection = "1; mode=block"
    X-Content-Type-Options = "nosniff"
    Referrer-Policy = "strict-origin-when-cross-origin"

# CORS CONFIGURATION
# -----------------
# CORS is handled in netlify/functions/contact.js using ALLOWED_ORIGINS environment variable
#
# IMPORTANT: In production, your site makes SAME-ORIGIN requests (e.g., yoursite.netlify.app â†’ yoursite.netlify.app/api/contact)
# CORS only applies when OTHER DOMAINS try to call your API (cross-origin requests)
#
# Set ALLOWED_ORIGINS in Netlify dashboard: Site settings > Environment variables
# Only add domains that should be allowed to call your API from a different origin
# Example: https://another-site.com,https://partner-site.com
#
# For development, localhost origins are configured in .env file

# Cache static assets (JS, CSS) for 1 year - they have hashed filenames
[[headers]]
  for = "/assets/*"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"

# Cache hashed images in /assets/ for 1 year (safe - filename changes when content changes)
[[headers]]
  for = "/assets/*.jpg"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"

[[headers]]
  for = "/assets/*.png"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"

[[headers]]
  for = "/assets/*.webp"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"

[[headers]]
  for = "/assets/*.svg"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"

# Cache root-level images for 1 week (allows updates to be seen sooner)
[[headers]]
  for = "/*.jpg"
  [headers.values]
    Cache-Control = "public, max-age=604800"

[[headers]]
  for = "/*.png"
  [headers.values]
    Cache-Control = "public, max-age=604800"

[[headers]]
  for = "/*.webp"
  [headers.values]
    Cache-Control = "public, max-age=604800"

[[headers]]
  for = "/*.svg"
  [headers.values]
    Cache-Control = "public, max-age=604800"

# Cache fonts for 1 year (fonts rarely change)
[[headers]]
  for = "*.woff2"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"

# Cache HTML for 1 hour (revalidate frequently for new deployments)
[[headers]]
  for = "/*.html"
  [headers.values]
    Cache-Control = "public, max-age=3600, must-revalidate"
